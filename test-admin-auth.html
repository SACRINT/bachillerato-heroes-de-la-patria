<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Admin Auth - BGE H√©roes de la Patria</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <div id="main-header"></div>

    <div class="container mt-5">
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">
                            <i class="fas fa-cog me-2"></i>Test Sistema de Autenticaci√≥n Admin
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6>Estado Actual:</h6>
                                <div id="authStatus" class="alert alert-secondary">
                                    <i class="fas fa-spinner fa-spin me-2"></i>Verificando...
                                </div>
                                
                                <h6>Elementos de Admin:</h6>
                                <div id="adminElements" class="alert alert-info">
                                    Verificando elementos...
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6>Acciones:</h6>
                                <div class="d-grid gap-2">
                                    <button class="btn btn-primary" onclick="checkAuthStatus()">
                                        <i class="fas fa-sync me-2"></i>Verificar Estado
                                    </button>
                                    <button class="btn btn-success" onclick="testLogin()">
                                        <i class="fas fa-sign-in-alt me-2"></i>Test Login
                                    </button>
                                    <button class="btn btn-warning" onclick="testLogout()">
                                        <i class="fas fa-sign-out-alt me-2"></i>Test Logout
                                    </button>
                                    <button class="btn btn-info" onclick="showConsoleInfo()">
                                        <i class="fas fa-terminal me-2"></i>Ver Console
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="row">
                            <div class="col-12">
                                <h6>Console Output:</h6>
                                <div id="consoleOutput" class="bg-dark text-light p-3 rounded" style="height: 200px; overflow-y: auto;">
                                    <small>Esperando eventos...</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/script.js"></script>
    
    <script>
        let originalConsoleLog = console.log;
        let consoleOutput = [];
        
        console.log = function(...args) {
            originalConsoleLog.apply(console, arguments);
            consoleOutput.push(args.join(' '));
            updateConsoleDisplay();
        };
        
        function updateConsoleDisplay() {
            const consoleDiv = document.getElementById('consoleOutput');
            if (consoleDiv) {
                consoleDiv.innerHTML = consoleOutput.slice(-10).map(line => 
                    `<small>${line}</small>`
                ).join('<br>');
                consoleDiv.scrollTop = consoleDiv.scrollHeight;
            }
        }
        
        function checkAuthStatus() {
            console.log('üîç Verificando estado de autenticaci√≥n...');
            
            const isAuth = window.isAdminAuthenticated ? window.isAdminAuthenticated() : false;
            const statusDiv = document.getElementById('authStatus');
            
            if (isAuth) {
                statusDiv.innerHTML = '<i class="fas fa-check-circle text-success me-2"></i>Administrador Autenticado';
                statusDiv.className = 'alert alert-success';
            } else {
                statusDiv.innerHTML = '<i class="fas fa-times-circle text-danger me-2"></i>No Autenticado';
                statusDiv.className = 'alert alert-danger';
            }
            
            // Verificar elementos de admin
            const adminElements = document.querySelectorAll('#adminOnlySection');
            const elementsDiv = document.getElementById('adminElements');
            elementsDiv.innerHTML = `
                <strong>Elementos encontrados:</strong> ${adminElements.length}<br>
                <strong>Estado:</strong> ${adminElements.length > 0 ? 
                    (adminElements[0].classList.contains('d-none') ? 'Ocultos' : 'Visibles') 
                    : 'No encontrados'}
            `;
            
            console.log('‚úÖ Estado verificado:', { isAuth, elementsFound: adminElements.length });
        }
        
        function testLogin() {
            console.log('üîë Abriendo modal de login...');
            if (window.showAdminPanelAuth) {
                window.showAdminPanelAuth();
            } else {
                console.error('‚ùå Funci√≥n showAdminPanelAuth no disponible');
            }
        }
        
        function testLogout() {
            console.log('üö™ Ejecutando logout...');
            if (window.logoutAdminPanel) {
                window.logoutAdminPanel();
            } else {
                console.error('‚ùå Funci√≥n logoutAdminPanel no disponible');
            }
            setTimeout(checkAuthStatus, 500);
        }
        
        function showConsoleInfo() {
            console.log('üìä Estado actual del sistema:');
            console.log('- adminAuth disponible:', typeof window.adminAuth !== 'undefined');
            console.log('- isAdminAuthenticated disponible:', typeof window.isAdminAuthenticated !== 'undefined');
            console.log('- showAdminPanelAuth disponible:', typeof window.showAdminPanelAuth !== 'undefined');
            console.log('- logoutAdminPanel disponible:', typeof window.logoutAdminPanel !== 'undefined');
        }
        
        // Auto-verificar estado cada 5 segundos
        setInterval(checkAuthStatus, 5000);
        
        // Verificar inicial
        setTimeout(checkAuthStatus, 1000);
    </script>
</body>
</html>
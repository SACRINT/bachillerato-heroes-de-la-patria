---
import { Layout } from '@heroes-patria/ui';
import { siteConfig } from '@heroes-patria/config';
---

<Layout 
  title="Calendario Escolar"
  description="Consulta el calendario escolar oficial del Bachillerato Héroes de la Patria (Héroes de Puebla). Fechas importantes, eventos, exámenes y actividades académicas del ciclo escolar 2024-2025."
  keywords={["calendario escolar", "fechas importantes", "eventos bachillerato", "examenes", "actividades academicas", "ciclo escolar", "heroes patria", "heroes puebla"]}
>
  <!-- Hero Section -->
  <section class="relative bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 text-white py-24">
    <div class="absolute inset-0 bg-[url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"%3E%3Cdefs%3E%3Cpattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"%3E%3Cpath d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/%3E%3C/pattern%3E%3C/defs%3E%3Crect width="100" height="100" fill="url(%23grid)"/%3E%3C/svg%3E')] opacity-30"></div>
    
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center">
        <!-- Breadcrumb -->
        <nav class="mb-6" aria-label="Breadcrumb">
          <ol class="flex items-center justify-center space-x-2 text-sm">
            <li><a href="/" class="text-gray-300 hover:text-white transition-colors duration-200">Inicio</a></li>
            <li><i class="fas fa-chevron-right text-gray-400 mx-2"></i></li>
            <li><span class="text-white font-semibold">Calendario Escolar</span></li>
          </ol>
        </nav>
        
        <!-- Title -->
        <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6">
          <i class="fas fa-calendar-alt mr-4 text-secondary-400"></i>
          Calendario Escolar
        </h1>
        
        <p class="text-xl text-gray-200 mb-8 leading-relaxed max-w-3xl mx-auto">
          Consulta todas las fechas importantes del ciclo escolar 2024-2025: períodos académicos, exámenes, eventos especiales y días festivos.
        </p>
        
        <!-- Current Date Info -->
        <div class="inline-flex items-center bg-white/10 backdrop-blur-sm rounded-full px-6 py-3 mb-8">
          <i class="fas fa-clock mr-3 text-secondary-400"></i>
          <span class="font-semibold">Ciclo Escolar 2024-2025</span>
        </div>

        <!-- Quick Navigation -->
        <div class="flex flex-wrap justify-center gap-3">
          <button onclick="goToCurrentMonth()" class="inline-flex items-center px-4 py-2 bg-secondary-500 hover:bg-secondary-600 text-primary-900 rounded-full transition-all duration-300 text-sm font-semibold">
            <i class="fas fa-calendar-day mr-2"></i>
            Mes Actual
          </button>
          <button onclick="showEventList()" class="inline-flex items-center px-4 py-2 bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white rounded-full transition-all duration-300 text-sm font-semibold">
            <i class="fas fa-list mr-2"></i>
            Lista de Eventos
          </button>
          <button onclick="showExamSchedule()" class="inline-flex items-center px-4 py-2 bg-white/10 backdrop-blur-sm hover:bg-white/20 text-white rounded-full transition-all duration-300 text-sm font-semibold">
            <i class="fas fa-clipboard-list mr-2"></i>
            Exámenes
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Calendar Navigation -->
  <section class="py-8 bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col md:flex-row items-center justify-between">
        <!-- Calendar Controls -->
        <div class="flex items-center space-x-4 mb-4 md:mb-0">
          <button onclick="previousMonth()" class="p-2 text-gray-600 hover:text-primary-600 dark:text-gray-400 dark:hover:text-primary-400 transition-colors duration-200">
            <i class="fas fa-chevron-left text-xl"></i>
          </button>
          <h2 id="current-month-year" class="text-2xl font-bold text-gray-900 dark:text-white min-w-[200px] text-center">
            Enero 2024
          </h2>
          <button onclick="nextMonth()" class="p-2 text-gray-600 hover:text-primary-600 dark:text-gray-400 dark:hover:text-primary-400 transition-colors duration-200">
            <i class="fas fa-chevron-right text-xl"></i>
          </button>
        </div>

        <!-- View Toggle -->
        <div class="flex bg-gray-100 dark:bg-gray-800 rounded-lg p-1">
          <button onclick="setView('month')" id="month-view-btn" class="px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 bg-primary-600 text-white">
            <i class="fas fa-calendar-alt mr-2"></i>Mes
          </button>
          <button onclick="setView('list')" id="list-view-btn" class="px-4 py-2 text-sm font-medium text-gray-600 dark:text-gray-300 rounded-md transition-all duration-200 hover:text-gray-900 dark:hover:text-white">
            <i class="fas fa-list mr-2"></i>Lista
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Calendar Grid -->
  <section id="calendar-view" class="py-12 bg-gray-50 dark:bg-gray-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Calendar Container -->
      <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg overflow-hidden">
        <!-- Days of Week Header -->
        <div class="grid grid-cols-7 bg-gray-100 dark:bg-gray-700">
          <div class="p-4 text-center font-semibold text-gray-700 dark:text-gray-300 border-r border-gray-200 dark:border-gray-600">Dom</div>
          <div class="p-4 text-center font-semibold text-gray-700 dark:text-gray-300 border-r border-gray-200 dark:border-gray-600">Lun</div>
          <div class="p-4 text-center font-semibold text-gray-700 dark:text-gray-300 border-r border-gray-200 dark:border-gray-600">Mar</div>
          <div class="p-4 text-center font-semibold text-gray-700 dark:text-gray-300 border-r border-gray-200 dark:border-gray-600">Mié</div>
          <div class="p-4 text-center font-semibold text-gray-700 dark:text-gray-300 border-r border-gray-200 dark:border-gray-600">Jue</div>
          <div class="p-4 text-center font-semibold text-gray-700 dark:text-gray-300 border-r border-gray-200 dark:border-gray-600">Vie</div>
          <div class="p-4 text-center font-semibold text-gray-700 dark:text-gray-300">Sáb</div>
        </div>
        
        <!-- Calendar Days Grid -->
        <div id="calendar-grid" class="grid grid-cols-7 min-h-[500px]">
          <!-- Days will be generated dynamically -->
        </div>
      </div>
    </div>
  </section>

  <!-- List View -->
  <section id="list-view" class="hidden py-12 bg-gray-50 dark:bg-gray-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Filter Tabs -->
      <div class="mb-8">
        <div class="flex flex-wrap justify-center gap-2">
          <button onclick="filterEvents('all')" class="filter-btn active px-4 py-2 rounded-full text-sm font-semibold transition-all duration-200">Todos</button>
          <button onclick="filterEvents('academic')" class="filter-btn px-4 py-2 rounded-full text-sm font-semibold transition-all duration-200">Académico</button>
          <button onclick="filterEvents('exam')" class="filter-btn px-4 py-2 rounded-full text-sm font-semibold transition-all duration-200">Exámenes</button>
          <button onclick="filterEvents('event')" class="filter-btn px-4 py-2 rounded-full text-sm font-semibold transition-all duration-200">Eventos</button>
          <button onclick="filterEvents('holiday')" class="filter-btn px-4 py-2 rounded-full text-sm font-semibold transition-all duration-200">Días Festivos</button>
        </div>
      </div>

      <!-- Events List -->
      <div id="events-list" class="space-y-4">
        <!-- Events will be populated dynamically -->
      </div>
    </div>
  </section>

  <!-- Event Details Modal -->
  <div id="event-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50 p-4">
    <div class="bg-white dark:bg-gray-800 rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between">
        <h3 id="modal-title" class="text-xl font-bold text-gray-900 dark:text-white"></h3>
        <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 transition-colors duration-200">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>
      <div class="p-6">
        <div id="modal-content" class="space-y-4">
          <!-- Modal content will be populated dynamically -->
        </div>
      </div>
    </div>
  </div>

  <!-- Important Dates Summary -->
  <section class="py-16 bg-white dark:bg-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Fechas Importantes del Ciclo Escolar</h2>
        <p class="text-xl text-gray-600 dark:text-gray-300">Resumen de los períodos y eventos más relevantes</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        <!-- Inicio de Clases -->
        <div class="bg-gradient-to-br from-green-50 to-green-100 dark:from-gray-700 dark:to-gray-600 rounded-2xl p-6 text-center">
          <div class="w-16 h-16 bg-green-500 rounded-full mx-auto mb-4 flex items-center justify-center">
            <i class="fas fa-play text-white text-xl"></i>
          </div>
          <h3 class="text-lg font-bold text-green-600 dark:text-green-400 mb-2">Inicio de Clases</h3>
          <p class="text-gray-700 dark:text-gray-300 font-semibold">26 de Agosto</p>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Primer día del ciclo escolar 2024-2025</p>
        </div>

        <!-- Exámenes Finales -->
        <div class="bg-gradient-to-br from-blue-50 to-blue-100 dark:from-gray-700 dark:to-gray-600 rounded-2xl p-6 text-center">
          <div class="w-16 h-16 bg-blue-500 rounded-full mx-auto mb-4 flex items-center justify-center">
            <i class="fas fa-clipboard-list text-white text-xl"></i>
          </div>
          <h3 class="text-lg font-bold text-blue-600 dark:text-blue-400 mb-2">Exámenes Finales</h3>
          <p class="text-gray-700 dark:text-gray-300 font-semibold">17-21 Jun</p>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Evaluaciones finales del ciclo</p>
        </div>

        <!-- Vacaciones de Verano -->
        <div class="bg-gradient-to-br from-orange-50 to-orange-100 dark:from-gray-700 dark:to-gray-600 rounded-2xl p-6 text-center">
          <div class="w-16 h-16 bg-orange-500 rounded-full mx-auto mb-4 flex items-center justify-center">
            <i class="fas fa-sun text-white text-xl"></i>
          </div>
          <h3 class="text-lg font-bold text-orange-600 dark:text-orange-400 mb-2">Vacaciones</h3>
          <p class="text-gray-700 dark:text-gray-300 font-semibold">24 Jun - 25 Ago</p>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Período de descanso de verano</p>
        </div>

        <!-- Graduación -->
        <div class="bg-gradient-to-br from-purple-50 to-purple-100 dark:from-gray-700 dark:to-gray-600 rounded-2xl p-6 text-center">
          <div class="w-16 h-16 bg-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center">
            <i class="fas fa-graduation-cap text-white text-xl"></i>
          </div>
          <h3 class="text-lg font-bold text-purple-600 dark:text-purple-400 mb-2">Graduación</h3>
          <p class="text-gray-700 dark:text-gray-300 font-semibold">15 de Julio</p>
          <p class="text-gray-600 dark:text-gray-400 text-sm">Ceremonia de clausura</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Academic Periods -->
  <section class="py-16 bg-gray-50 dark:bg-gray-900">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-4">Períodos Académicos</h2>
        <p class="text-xl text-gray-600 dark:text-gray-300">División del año escolar en períodos de evaluación</p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <!-- Primer Parcial -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-all duration-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center mr-4">
              <span class="text-white font-bold">1°</span>
            </div>
            <div>
              <h3 class="text-lg font-bold text-gray-900 dark:text-white">Primer Parcial</h3>
              <p class="text-red-600 dark:text-red-400 font-semibold">26 Ago - 11 Oct</p>
            </div>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">Período inicial de adaptación y evaluación diagnóstica</p>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            <p><strong>Examen:</strong> 14-18 Oct</p>
            <p><strong>Entrega de calificaciones:</strong> 21 Oct</p>
          </div>
        </div>

        <!-- Segundo Parcial -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-all duration-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center mr-4">
              <span class="text-white font-bold">2°</span>
            </div>
            <div>
              <h3 class="text-lg font-bold text-gray-900 dark:text-white">Segundo Parcial</h3>
              <p class="text-blue-600 dark:text-blue-400 font-semibold">21 Oct - 15 Dic</p>
            </div>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">Consolidación de conocimientos y habilidades básicas</p>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            <p><strong>Examen:</strong> 16-20 Dic</p>
            <p><strong>Entrega de calificaciones:</strong> 23 Dic</p>
          </div>
        </div>

        <!-- Tercer Parcial -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-all duration-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center mr-4">
              <span class="text-white font-bold">3°</span>
            </div>
            <div>
              <h3 class="text-lg font-bold text-gray-900 dark:text-white">Tercer Parcial</h3>
              <p class="text-green-600 dark:text-green-400 font-semibold">8 Ene - 7 Mar</p>
            </div>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">Desarrollo de competencias intermedias</p>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            <p><strong>Examen:</strong> 10-14 Mar</p>
            <p><strong>Entrega de calificaciones:</strong> 17 Mar</p>
          </div>
        </div>

        <!-- Cuarto Parcial -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-all duration-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center mr-4">
              <span class="text-white font-bold">4°</span>
            </div>
            <div>
              <h3 class="text-lg font-bold text-gray-900 dark:text-white">Cuarto Parcial</h3>
              <p class="text-purple-600 dark:text-purple-400 font-semibold">17 Mar - 9 May</p>
            </div>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">Aplicación práctica de conocimientos adquiridos</p>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            <p><strong>Examen:</strong> 12-16 May</p>
            <p><strong>Entrega de calificaciones:</strong> 19 May</p>
          </div>
        </div>

        <!-- Quinto Parcial -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-all duration-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg flex items-center justify-center mr-4">
              <span class="text-white font-bold">5°</span>
            </div>
            <div>
              <h3 class="text-lg font-bold text-gray-900 dark:text-white">Quinto Parcial</h3>
              <p class="text-orange-600 dark:text-orange-400 font-semibold">19 May - 13 Jun</p>
            </div>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">Preparación para evaluaciones finales</p>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            <p><strong>Examen:</strong> 17-21 Jun</p>
            <p><strong>Entrega de calificaciones:</strong> 24 Jun</p>
          </div>
        </div>

        <!-- Extraordinarios -->
        <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 border-2 border-yellow-300">
          <div class="flex items-center mb-4">
            <div class="w-12 h-12 bg-gradient-to-br from-yellow-500 to-yellow-600 rounded-lg flex items-center justify-center mr-4">
              <i class="fas fa-redo text-white"></i>
            </div>
            <div>
              <h3 class="text-lg font-bold text-gray-900 dark:text-white">Extraordinarios</h3>
              <p class="text-yellow-600 dark:text-yellow-400 font-semibold">1-12 Jul</p>
            </div>
          </div>
          <p class="text-gray-600 dark:text-gray-300 text-sm mb-4">Oportunidad de regularización para estudiantes</p>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            <p><strong>Inscripción:</strong> 24-28 Jun</p>
            <p><strong>Resultados:</strong> 15 Jul</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Download Calendar -->
  <section class="py-16 bg-primary-600 text-white">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl font-bold mb-4">¿Necesitas el calendario offline?</h2>
      <p class="text-xl text-blue-100 mb-8">Descarga nuestro calendario oficial en formato PDF</p>
      
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <button onclick="downloadCalendar('pdf')" class="inline-flex items-center px-8 py-4 bg-secondary-500 hover:bg-secondary-600 text-primary-900 font-semibold rounded-xl transition-all duration-300 transform hover:scale-105 shadow-lg">
          <i class="fas fa-file-pdf mr-3"></i>
          Descargar PDF
        </button>
        <button onclick="downloadCalendar('ical')" class="inline-flex items-center px-8 py-4 bg-white/20 hover:bg-white/30 backdrop-blur-sm font-semibold rounded-xl transition-all duration-300 transform hover:scale-105">
          <i class="fas fa-calendar-plus mr-3"></i>
          Agregar a mi calendario
        </button>
      </div>
    </div>
  </section>
</Layout>

<script>
  // Calendar State
  let currentDate = new Date();
  let currentView = 'month';
  let selectedDate = null;

  // Event Types Configuration
  const eventTypes = {
    academic: { color: 'bg-blue-500', textColor: 'text-blue-600', name: 'Académico' },
    exam: { color: 'bg-red-500', textColor: 'text-red-600', name: 'Examen' },
    event: { color: 'bg-green-500', textColor: 'text-green-600', name: 'Evento' },
    holiday: { color: 'bg-purple-500', textColor: 'text-purple-600', name: 'Día Festivo' },
    vacation: { color: 'bg-orange-500', textColor: 'text-orange-600', name: 'Vacaciones' }
  };

  // Sample Events Data
  const events = [
    {
      id: 1,
      title: 'Inicio del Ciclo Escolar 2024-2025',
      date: '2024-08-26',
      type: 'academic',
      description: 'Primer día de clases del nuevo ciclo escolar. Bienvenida a estudiantes y presentación de horarios.',
      time: '07:30 AM'
    },
    {
      id: 2,
      title: 'Día de la Independencia',
      date: '2024-09-16',
      type: 'holiday',
      description: 'Celebración del Día de la Independencia de México. Día festivo oficial.',
      time: 'Todo el día'
    },
    {
      id: 3,
      title: 'Exámenes Primer Parcial',
      date: '2024-10-14',
      endDate: '2024-10-18',
      type: 'exam',
      description: 'Semana de evaluaciones del primer período académico.',
      time: '08:00 AM'
    },
    {
      id: 4,
      title: 'Día de Muertos',
      date: '2024-11-02',
      type: 'holiday',
      description: 'Día de los Fieles Difuntos. Actividades culturales y altares.',
      time: 'Todo el día'
    },
    {
      id: 5,
      title: 'Festival Cultural de Otoño',
      date: '2024-11-15',
      type: 'event',
      description: 'Presentaciones artísticas y culturales de los estudiantes.',
      time: '10:00 AM'
    },
    {
      id: 6,
      title: 'Vacaciones de Invierno',
      date: '2024-12-23',
      endDate: '2025-01-07',
      type: 'vacation',
      description: 'Período de descanso navideño.',
      time: 'Todo el día'
    },
    {
      id: 7,
      title: 'Reinicio de Clases',
      date: '2025-01-08',
      type: 'academic',
      description: 'Regreso a clases después del período vacacional de invierno.',
      time: '07:30 AM'
    },
    {
      id: 8,
      title: 'Día de la Constitución',
      date: '2025-02-05',
      type: 'holiday',
      description: 'Conmemoración de la Constitución Mexicana.',
      time: 'Todo el día'
    },
    {
      id: 9,
      title: 'Día del Amor y la Amistad',
      date: '2025-02-14',
      type: 'event',
      description: 'Celebración especial con actividades recreativas.',
      time: '12:00 PM'
    },
    {
      id: 10,
      title: 'Semana de Ciencias',
      date: '2025-03-10',
      endDate: '2025-03-14',
      type: 'academic',
      description: 'Feria científica y proyectos CTIM de estudiantes.',
      time: '09:00 AM'
    },
    {
      id: 11,
      title: 'Vacaciones de Primavera',
      date: '2025-03-24',
      endDate: '2025-04-07',
      type: 'vacation',
      description: 'Período de descanso de Semana Santa.',
      time: 'Todo el día'
    },
    {
      id: 12,
      title: 'Día del Trabajo',
      date: '2025-05-01',
      type: 'holiday',
      description: 'Día del Trabajador. Día festivo oficial.',
      time: 'Todo el día'
    },
    {
      id: 13,
      title: 'Día de las Madres',
      date: '2025-05-10',
      type: 'event',
      description: 'Ceremonia especial en honor a las madres de familia.',
      time: '10:00 AM'
    },
    {
      id: 14,
      title: 'Exámenes Finales',
      date: '2025-06-17',
      endDate: '2025-06-21',
      type: 'exam',
      description: 'Evaluaciones finales del ciclo escolar.',
      time: '08:00 AM'
    },
    {
      id: 15,
      title: 'Ceremonia de Graduación',
      date: '2025-07-15',
      type: 'event',
      description: 'Clausura del ciclo escolar y graduación de estudiantes de sexto semestre.',
      time: '10:00 AM'
    }
  ];

  // Initialize Calendar
  document.addEventListener('DOMContentLoaded', function() {
    updateCalendar();
    updateCurrentMonthYear();
    setupFilterButtons();
  });

  // Calendar Navigation Functions
  function previousMonth() {
    currentDate.setMonth(currentDate.getMonth() - 1);
    updateCalendar();
    updateCurrentMonthYear();
  }

  function nextMonth() {
    currentDate.setMonth(currentDate.getMonth() + 1);
    updateCalendar();
    updateCurrentMonthYear();
  }

  function goToCurrentMonth() {
    currentDate = new Date();
    updateCalendar();
    updateCurrentMonthYear();
  }

  function updateCurrentMonthYear() {
    const months = [
      'Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
      'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'
    ];
    const monthYearElement = document.getElementById('current-month-year');
    if (monthYearElement) {
      monthYearElement.textContent = `${months[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
    }
  }

  // View Toggle Functions
  function setView(view) {
    currentView = view;
    const monthBtn = document.getElementById('month-view-btn');
    const listBtn = document.getElementById('list-view-btn');
    const calendarView = document.getElementById('calendar-view');
    const listView = document.getElementById('list-view');

    if (view === 'month') {
      monthBtn?.classList.add('bg-primary-600', 'text-white');
      monthBtn?.classList.remove('text-gray-600', 'dark:text-gray-300');
      listBtn?.classList.remove('bg-primary-600', 'text-white');
      listBtn?.classList.add('text-gray-600', 'dark:text-gray-300');
      calendarView?.classList.remove('hidden');
      listView?.classList.add('hidden');
    } else {
      listBtn?.classList.add('bg-primary-600', 'text-white');
      listBtn?.classList.remove('text-gray-600', 'dark:text-gray-300');
      monthBtn?.classList.remove('bg-primary-600', 'text-white');
      monthBtn?.classList.add('text-gray-600', 'dark:text-gray-300');
      calendarView?.classList.add('hidden');
      listView?.classList.remove('hidden');
      updateEventsList();
    }
  }

  function showEventList() {
    setView('list');
  }

  function showExamSchedule() {
    setView('list');
    filterEvents('exam');
  }

  // Calendar Grid Update
  function updateCalendar() {
    const grid = document.getElementById('calendar-grid');
    if (!grid) return;

    grid.innerHTML = '';

    const year = currentDate.getFullYear();
    const month = currentDate.getMonth();
    const firstDay = new Date(year, month, 1);
    const lastDay = new Date(year, month + 1, 0);
    const startDate = new Date(firstDay);
    startDate.setDate(startDate.getDate() - firstDay.getDay());

    // Generate 42 days (6 weeks)
    for (let i = 0; i < 42; i++) {
      const date = new Date(startDate);
      date.setDate(startDate.getDate() + i);
      
      const dayElement = createDayElement(date, month);
      grid.appendChild(dayElement);
    }
  }

  function createDayElement(date, currentMonth) {
    const dayDiv = document.createElement('div');
    const dateStr = date.toISOString().split('T')[0];
    const dayEvents = events.filter(event => {
      if (event.endDate) {
        return dateStr >= event.date && dateStr <= event.endDate;
      }
      return event.date === dateStr;
    });

    const isCurrentMonth = date.getMonth() === currentMonth;
    const isToday = dateStr === new Date().toISOString().split('T')[0];

    dayDiv.className = `p-2 min-h-[80px] border-b border-r border-gray-200 dark:border-gray-600 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-200 ${
      !isCurrentMonth ? 'text-gray-400 bg-gray-50 dark:bg-gray-800 dark:text-gray-500' : 'bg-white dark:bg-gray-800'
    } ${isToday ? 'bg-blue-50 dark:bg-blue-900/20' : ''}`;

    dayDiv.addEventListener('click', () => showDayEvents(date, dayEvents));

    // Day number
    const dayNumber = document.createElement('div');
    dayNumber.className = `text-sm font-semibold mb-1 ${isToday ? 'text-blue-600 dark:text-blue-400' : 'text-gray-900 dark:text-white'}`;
    dayNumber.textContent = date.getDate().toString();
    dayDiv.appendChild(dayNumber);

    // Events for this day
    dayEvents.slice(0, 2).forEach(event => {
      const eventDiv = document.createElement('div');
      eventDiv.className = `text-xs p-1 mb-1 rounded ${eventTypes[event.type].color} text-white cursor-pointer hover:opacity-80 transition-opacity duration-200`;
      eventDiv.textContent = event.title.length > 20 ? event.title.substring(0, 20) + '...' : event.title;
      eventDiv.addEventListener('click', (e) => {
        e.stopPropagation();
        showEventModal(event);
      });
      dayDiv.appendChild(eventDiv);
    });

    // More events indicator
    if (dayEvents.length > 2) {
      const moreDiv = document.createElement('div');
      moreDiv.className = 'text-xs text-gray-500 dark:text-gray-400 cursor-pointer hover:text-gray-700 dark:hover:text-gray-200';
      moreDiv.textContent = `+${dayEvents.length - 2} más`;
      moreDiv.addEventListener('click', (e) => {
        e.stopPropagation();
        showDayEvents(date, dayEvents);
      });
      dayDiv.appendChild(moreDiv);
    }

    return dayDiv;
  }

  // Event List Functions
  function updateEventsList(filter = 'all') {
    const eventsList = document.getElementById('events-list');
    if (!eventsList) return;

    const filteredEvents = filter === 'all' ? events : events.filter(event => event.type === filter);
    const sortedEvents = filteredEvents.sort((a, b) => new Date(a.date) - new Date(b.date));

    eventsList.innerHTML = sortedEvents.map(event => `
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 cursor-pointer" onclick="showEventModal(${JSON.stringify(event).replace(/"/g, '&quot;')})">
        <div class="flex items-start justify-between">
          <div class="flex-1">
            <div class="flex items-center mb-2">
              <div class="w-3 h-3 ${eventTypes[event.type].color} rounded-full mr-3"></div>
              <span class="text-xs font-semibold ${eventTypes[event.type].textColor} bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded-full">
                ${eventTypes[event.type].name}
              </span>
            </div>
            <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-2">${event.title}</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-3">${event.description}</p>
            <div class="flex items-center text-sm text-gray-500 dark:text-gray-400">
              <i class="fas fa-calendar mr-2"></i>
              <span>${formatDate(event.date)}${event.endDate ? ' - ' + formatDate(event.endDate) : ''}</span>
              <i class="fas fa-clock ml-4 mr-2"></i>
              <span>${event.time}</span>
            </div>
          </div>
        </div>
      </div>
    `).join('');
  }

  // Filter Functions
  function setupFilterButtons() {
    const buttons = document.querySelectorAll('.filter-btn');
    buttons.forEach(btn => {
      btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300', 'hover:bg-gray-300', 'dark:hover:bg-gray-600');
    });
    
    // Set active button
    const activeBtn = document.querySelector('.filter-btn.active');
    if (activeBtn) {
      activeBtn.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
      activeBtn.classList.add('bg-primary-600', 'text-white');
    }
  }

  function filterEvents(type) {
    // Update active button
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.classList.remove('active', 'bg-primary-600', 'text-white');
      btn.classList.add('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
    });
    
    event.target.classList.add('active', 'bg-primary-600', 'text-white');
    event.target.classList.remove('bg-gray-200', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
    
    updateEventsList(type);
  }

  // Modal Functions
  function showEventModal(event) {
    const modal = document.getElementById('event-modal');
    const title = document.getElementById('modal-title');
    const content = document.getElementById('modal-content');
    
    if (!modal || !title || !content) return;

    title.textContent = event.title;
    content.innerHTML = `
      <div class="flex items-center mb-4">
        <div class="w-4 h-4 ${eventTypes[event.type].color} rounded-full mr-3"></div>
        <span class="text-sm font-semibold ${eventTypes[event.type].textColor}">
          ${eventTypes[event.type].name}
        </span>
      </div>
      <div class="space-y-3">
        <div class="flex items-center text-gray-600 dark:text-gray-300">
          <i class="fas fa-calendar mr-3 w-4"></i>
          <span>${formatDate(event.date)}${event.endDate ? ' - ' + formatDate(event.endDate) : ''}</span>
        </div>
        <div class="flex items-center text-gray-600 dark:text-gray-300">
          <i class="fas fa-clock mr-3 w-4"></i>
          <span>${event.time}</span>
        </div>
        <div class="mt-4">
          <p class="text-gray-700 dark:text-gray-300 leading-relaxed">${event.description}</p>
        </div>
      </div>
    `;
    
    modal.classList.remove('hidden');
    document.body.classList.add('overflow-hidden');
  }

  function showDayEvents(date, dayEvents) {
    if (dayEvents.length === 0) return;
    
    const modal = document.getElementById('event-modal');
    const title = document.getElementById('modal-title');
    const content = document.getElementById('modal-content');
    
    if (!modal || !title || !content) return;

    title.textContent = `Eventos - ${formatDate(date.toISOString().split('T')[0])}`;
    content.innerHTML = dayEvents.map(event => `
      <div class="border-b border-gray-200 dark:border-gray-600 pb-4 mb-4 last:border-b-0 last:pb-0 last:mb-0">
        <div class="flex items-center mb-2">
          <div class="w-3 h-3 ${eventTypes[event.type].color} rounded-full mr-3"></div>
          <span class="text-sm font-semibold ${eventTypes[event.type].textColor}">
            ${eventTypes[event.type].name}
          </span>
        </div>
        <h4 class="font-bold text-gray-900 dark:text-white mb-2">${event.title}</h4>
        <p class="text-gray-600 dark:text-gray-300 text-sm mb-2">${event.description}</p>
        <div class="flex items-center text-xs text-gray-500 dark:text-gray-400">
          <i class="fas fa-clock mr-1"></i>
          <span>${event.time}</span>
        </div>
      </div>
    `).join('');
    
    modal.classList.remove('hidden');
    document.body.classList.add('overflow-hidden');
  }

  function closeModal() {
    const modal = document.getElementById('event-modal');
    if (modal) {
      modal.classList.add('hidden');
      document.body.classList.remove('overflow-hidden');
    }
  }

  // Utility Functions
  function formatDate(dateStr) {
    const date = new Date(dateStr);
    const months = [
      'Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun',
      'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'
    ];
    return `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
  }

  // Download Functions
  function downloadCalendar(format) {
    if (format === 'pdf') {
      // Simulate PDF download
      const link = document.createElement('a');
      link.href = '/documents/calendario-escolar-2024-2025.pdf';
      link.download = 'calendario-escolar-2024-2025.pdf';
      link.click();
    } else if (format === 'ical') {
      // Generate iCal format
      let icalContent = 'BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//BGE Heroes de la Patria//ES\n';
      
      events.forEach(event => {
        const startDate = event.date.replace(/-/g, '');
        const endDate = event.endDate ? event.endDate.replace(/-/g, '') : startDate;
        
        icalContent += `BEGIN:VEVENT\n`;
        icalContent += `UID:${event.id}@heroesdelapatria.edu.mx\n`;
        icalContent += `DTSTART:${startDate}\n`;
        icalContent += `DTEND:${endDate}\n`;
        icalContent += `SUMMARY:${event.title}\n`;
        icalContent += `DESCRIPTION:${event.description}\n`;
        icalContent += `END:VEVENT\n`;
      });
      
      icalContent += 'END:VCALENDAR';
      
      const blob = new Blob([icalContent], { type: 'text/calendar' });
      const link = document.createElement('a');
      link.href = window.URL.createObjectURL(blob);
      link.download = 'calendario-heroes-patria-2024-2025.ics';
      link.click();
    }
  }

  // Make functions globally available
  window.previousMonth = previousMonth;
  window.nextMonth = nextMonth;
  window.goToCurrentMonth = goToCurrentMonth;
  window.setView = setView;
  window.showEventList = showEventList;
  window.showExamSchedule = showExamSchedule;
  window.filterEvents = filterEvents;
  window.showEventModal = showEventModal;
  window.closeModal = closeModal;
  window.downloadCalendar = downloadCalendar;

  // Close modal on outside click
  document.getElementById('event-modal')?.addEventListener('click', function(e) {
    if (e.target === this) {
      closeModal();
    }
  });

  // Keyboard shortcuts
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
      closeModal();
    } else if (e.key === 'ArrowLeft') {
      previousMonth();
    } else if (e.key === 'ArrowRight') {
      nextMonth();
    }
  });
</script>

<style>
  .glass {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  /* Calendar grid responsive adjustments */
  @media (max-width: 768px) {
    #calendar-grid {
      font-size: 0.75rem;
    }
    
    #calendar-grid > div {
      min-height: 60px;
      padding: 0.25rem;
    }
  }

  /* Smooth transitions for view changes */
  #calendar-view, #list-view {
    transition: opacity 0.3s ease-in-out;
  }

  /* Custom scrollbar for modal */
  .modal-content::-webkit-scrollbar {
    width: 4px;
  }

  .modal-content::-webkit-scrollbar-track {
    background: transparent;
  }

  .modal-content::-webkit-scrollbar-thumb {
    background: rgba(156, 163, 175, 0.5);
    border-radius: 2px;
  }
</style>